(ql:quickload :boots)

(defpackage :boots/examples/layout
  (:use :cl)
  (:export :run))

(in-package :boots/examples/layout)

(defun draw (char)
  (lambda (pad)
    (boots:paint pad char)))

(defparameter *example*
  (boots:stack ()
    (boots:pile (:height 10)
      (boots:make-canvas :border t :width 8 :height 4 :margin-top 1 :margin-left 1 :fill-char #\1)
      (boots:make-canvas :border t :width 8 :height 4 :margin-top 2 :margin-left 4 :draw (draw #\2))
      (boots:make-canvas :border t :width 8 :height 4 :margin-top 3 :margin-left 7 :draw (draw #\3)))
    (boots:shelf (:padding-vertical 1 :fill-char #\~)
      (boots:make-canvas :border-right t :padding 2 :fill-char #\< :draw (draw #\4))
      (boots:pile ()
        (boots:stack (:border t :margin t :margin-top 0.15)
          (boots:make-canvas :height 1 :border-bottom t :draw (draw #\5))
          (boots:canvas () (pad)
            (boots:paint pad #\6)
            (boots:paint pad #\nul :x 1 :y 1 :width 2 :height 2)
            (boots:draw pad 0 0 nil))
          (boots:make-canvas :height 1 :border-top t :draw (draw #\7)))
        (boots:stack ()
          (boots:make-canvas :draw (draw #\.))
          (boots:make-canvas :draw (draw #\9))))
      (boots:make-canvas :border-left t :padding 2 :fill-char #\> :draw (draw #\0)))))

;;; The resulting layout will look something like this (depending on the
;;; terminal size):
;;;
;;; ┌────────┐
;;; │11111111│──┐
;;; │11111111│22│──┐
;;; │11111111│22│33│
;;; │11111111│22│33│
;;; └────────┘22│33│
;;;    └────────┘33│
;;;       └────────┘
;;;
;;;~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
;;;<<<<<<<<<<<<<<<<<<<<<<<│.......................│>>>>>>>>>>>>>>>>>>>>>>>
;;;<<<<<<<<<<<<<<<<<<<<<<<│.......................│>>>>>>>>>>>>>>>>>>>>>>>
;;;<<4444444444444444444<<│.......................│>>0000000000000000000>>
;;;<<4444444444444444444<<│.......┌───────┐.......│>>0000000000000000000>>
;;;<<4444444444444444444<<│.......│5555555│.......│>>0000000000000000000>>
;;;<<4444444444444444444<<│.......│───────│.......│>>0000000000000000000>>
;;;<<4444444444444444444<<│.......│.666666│.......│>>0000000000000000000>>
;;;<<4444444444444444444<<│.......│6..6666│.......│>>0000000000000000000>>
;;;<<4444444444444444444<<│.......│6..6666│.......│>>0000000000000000000>>
;;;<<4444444444444444444<<│.......│6666666│.......│>>0000000000000000000>>
;;;<<4444444444444444444<<│.......│6666666│.......│>>0000000000000000000>>
;;;<<4444444444444444444<<│.......│6666666│.......│>>0000000000000000000>>
;;;<<4444444444444444444<<│.......│───────│.......│>>0000000000000000000>>
;;;<<4444444444444444444<<│9999999│7777777│9999999│>>0000000000000000000>>
;;;<<4444444444444444444<<│9999999└───────┘9999999│>>0000000000000000000>>
;;;<<4444444444444444444<<│99999999999999999999999│>>0000000000000000000>>
;;;<<4444444444444444444<<│99999999999999999999999│>>0000000000000000000>>
;;;<<4444444444444444444<<│99999999999999999999999│>>0000000000000000000>>
;;;<<4444444444444444444<<│99999999999999999999999│>>0000000000000000000>>
;;;<<4444444444444444444<<│99999999999999999999999│>>0000000000000000000>>
;;;<<4444444444444444444<<│99999999999999999999999│>>0000000000000000000>>
;;;<<4444444444444444444<<│99999999999999999999999│>>0000000000000000000>>
;;;<<4444444444444444444<<│99999999999999999999999│>>0000000000000000000>>
;;;<<<<<<<<<<<<<<<<<<<<<<<│99999999999999999999999│>>>>>>>>>>>>>>>>>>>>>>>
;;;<<<<<<<<<<<<<<<<<<<<<<<│99999999999999999999999│>>>>>>>>>>>>>>>>>>>>>>>
;;;~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

(defun run ()
  (boots:with-light-borders
    (boots/terminals/ansi:with-ansi-terminal (terminal)
      (boots:with-screen (boots:*screen* terminal :root *example*)
        (boots:redraw)
        (boots:read-event)))))
